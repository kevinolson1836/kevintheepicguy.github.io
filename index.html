<!DOCTYPE html>
<html>

    <head>
		
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Orbitron">
    </head>

  <body>
	

    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>

		<script type="importmap">
			{
				"imports": {
					"three": "../build/three.module.js"
				}
			}
		</script>

    <div class="face">
    <script type="module">

			import * as THREE from 'three';

			import { OBJLoader } from './jsm/loaders/OBJLoader.js';

			let container;

			let camera, scene, renderer;

			let mouseX = 0, mouseY = 0;

			let windowHalfX = window.innerWidth / 2;
			let windowHalfY = window.innerHeight / 2;

			let object;

			init();
			animate();


			function init() {

				container = document.getElementById( 'myCanvas' );
        container.style.css = "position:absolute; top: 10px; width:100%;height:100%;opacity:0.3;z-index:100;background:red;";
        // container.style.height = "100px";
				document.body.before( container );

				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 2000 );
				camera.position.z = 250;

				// scene

				scene = new THREE.Scene();
        // scene.background = new THREE.Color( 0 );
				const ambientLight = new THREE.AmbientLight( 0xcccccc, 0.4 );
				scene.add( ambientLight );

				const pointLight = new THREE.PointLight( 0xffffff, 0.8 );
				camera.add( pointLight );
				scene.add( camera );
        

				// manager

				function loadModel() {

					object.traverse( function ( child ) {

						if ( child.isMesh ) child.material.map = texture;

					} );

					// object.position.y = - 95;
					scene.add( object );

				}

				const manager = new THREE.LoadingManager( loadModel );

				// texture

				const textureLoader = new THREE.TextureLoader( manager );
				const texture = textureLoader.load( 'models/head3d.jpg' );

				// model

				function onProgress( xhr ) {

					if ( xhr.lengthComputable ) {

						const percentComplete = xhr.loaded / xhr.total * 100;
						console.log( 'model ' + Math.round( percentComplete, 2 ) + '% downloaded' );

					}

				}

				function onError() {}

				const loader = new OBJLoader( manager );
				loader.load( 'models/head3d.obj', function ( obj ) {

					object = obj;

				}, onProgress, onError );

				//

				renderer = new THREE.WebGLRenderer( { alpha: true, canvas: document.getElementById( 'canvasdd' ) } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth/3, window.innerHeight/3);
				// render.style("display: block")
				container.appendChild( renderer.domElement );

				document.addEventListener( 'mousemove', onDocumentMouseMove );

				//

				window.addEventListener( 'resize', onWindowResize );

			}

			function onWindowResize() {

				windowHalfX = window.innerWidth / 2;
				windowHalfY = window.innerHeight / 2;

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			function onDocumentMouseMove( event ) {

				mouseX = ( event.clientX - windowHalfX ) /2;
				mouseY = ( event.clientY - windowHalfY ) /2;

			}

			//

			function animate() {

				requestAnimationFrame( animate );
				render();

			}

			function render() {

				camera.position.x += ( -mouseX - camera.position.x ) * .05;
				camera.position.y -= (  -mouseY + camera.position.y ) * .05;

				// console.log("x:", camera.position.x, "y:", camera.position.y)
				camera.lookAt( scene.position );

				renderer.render( scene, camera );

			}

		</script>
</div>


    <!-- navigation bar -->
    <div class="topnav">
      <a class="active" href="#" >Home</a>
      <a href="projectsHome.html" >Projects</a>
      <a href="aboutMe.html">About me</a>
    </div>



    <!-- header on top page -->
    <div id="myCanvas" class="header" >
		<canvas id="canvasdd"></canvas>
      <h2 >Welcome (WIP)</h2>
	  <div class="loader">
		<div style="text-align: center;">
			loading model...
		</div>
	  </div>
	  
	 

    </div>
	    <!-- spacer div -->
    <div class="sapcer"></div>

      <div class="ghostBox">
        <div class="leftBox">
            <p1> some shiz</p1>
        </div>
      </div>

      <div class="ghostBox">
        <div class="rightBox">
            <p1> some shiz</p1>
        </div>
      </div>

      

   </div>


    <!-- footer div -->
    <div class="footer">
      <h2>Footer, maybe return to top and contact info or some fun fact idk man</h2>
    </div>

  </body>
  <style>
	.loader {
		-webkit-animation: load-out 1s;
		animation: load-out 1s;
		-webkit-animation-fill-mode: forwards;
		animation-fill-mode: forwards;
	}
	
	@-webkit-keyframes load-out {
		from {
			top: 0;
			opacity: 1;
		}
	
		to {
			top: 100%;
			opacity: 0;
		}
	}
	
	@keyframes load-out {
		from {
			top: 0;
			opacity: 1;
		}
	
		to {
			top: 100%;
			opacity: 0;
		}
	}
	</style>
</html>
